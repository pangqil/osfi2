name: Autograding Tests
'on':
- workflow_dispatch
- repository_dispatch
permissions:
  checks: write
  actions: read
  contents: read
jobs:
  run-autograding-tests:
    runs-on: ubuntu-latest
    if: github.actor != 'github-classroom[bot]'
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    - name: Missed arguments test
      id: missed-arguments-test
      uses: classroom-resources/autograding-command-grader@v1
      with:
        test-name: Missed arguments test
        setup-command: ''
        command: make test ARG=1
        timeout: 10
        max-score: 10
    - name: Square sized matrix test
      id: square-sized-matrix-test
      uses: classroom-resources/autograding-command-grader@v1
      with:
        test-name: Square sized matrix test
        setup-command: ''
        command: make test ARG=2
        timeout: 10
        max-score: 10
    - name: File size test
      id: file-size-test
      uses: classroom-resources/autograding-command-grader@v1
      with:
        test-name: File size test
        setup-command: ''
        command: make test ARG=3
        timeout: 10
        max-score: 10
    - name: 2 x 2 matrix test
      id: 2-x-2-matrix-test
      uses: classroom-resources/autograding-command-grader@v1
      with:
        test-name: 2 x 2 matrix test
        setup-command: ''
        command: make test ARG=4
        timeout: 10
        max-score: 10
    - name: 10 x 10 matrix test
      id: 10-x-10-matrix-test
      uses: classroom-resources/autograding-command-grader@v1
      with:
        test-name: 10 x 10 matrix test
        setup-command: ''
        command: make test ARG=5
        timeout: 10
        max-score: 10
    - name: 100 x 100 matrix test
      id: 100-x-100-matrix-test
      uses: classroom-resources/autograding-command-grader@v1
      with:
        test-name: 100 x 100 matrix test
        setup-command: ''
        command: make test ARG=6
        timeout: 10
        max-score: 10
    - name: 1024 x 1024 matrix test
      id: 1024-x-1024-matrix-test
      uses: classroom-resources/autograding-command-grader@v1
      with:
        test-name: 1024 x 1024 matrix test
        setup-command: ''
        command: make test ARG=7
        timeout: 10
        max-score: 20
    - name: Are there n threads in work?
      id: are-there-n-threads-in-work
      uses: classroom-resources/autograding-command-grader@v1
      with:
        test-name: Are there n threads in work?
        setup-command: ''
        command: make test ARG=8
        timeout: 10
        max-score: 20
    - name: Autograding Reporter
      uses: classroom-resources/autograding-grading-reporter@v1
      env:
        MISSED-ARGUMENTS-TEST_RESULTS: "${{steps.missed-arguments-test.outputs.result}}"
        SQUARE-SIZED-MATRIX-TEST_RESULTS: "${{steps.square-sized-matrix-test.outputs.result}}"
        FILE-SIZE-TEST_RESULTS: "${{steps.file-size-test.outputs.result}}"
        2-X-2-MATRIX-TEST_RESULTS: "${{steps.2-x-2-matrix-test.outputs.result}}"
        10-X-10-MATRIX-TEST_RESULTS: "${{steps.10-x-10-matrix-test.outputs.result}}"
        100-X-100-MATRIX-TEST_RESULTS: "${{steps.100-x-100-matrix-test.outputs.result}}"
        1024-X-1024-MATRIX-TEST_RESULTS: "${{steps.1024-x-1024-matrix-test.outputs.result}}"
        ARE-THERE-N-THREADS-IN-WORK_RESULTS: "${{steps.are-there-n-threads-in-work.outputs.result}}"
      with:
        runners: missed-arguments-test,square-sized-matrix-test,file-size-test,2-x-2-matrix-test,10-x-10-matrix-test,100-x-100-matrix-test,1024-x-1024-matrix-test,are-there-n-threads-in-work
